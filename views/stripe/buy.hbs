<h1>ALIVE</h1>
{{#auctions}}
  <h2>Buying Auction for {{firstname}}</h2>

  <form action="/buy" method="POST" id="payment-form">
    {{#if errors}}
      <span class="payment-errors">{{errors}}</span>
    {{/if}}
    <div class="form-row">
      <label>
        <span>Card Number</span>
        <input type="text" size="20" data-stripe="number"/>
      </label>
    </div>

    <div class="form-row">
      <label>
        <span>CVC</span>
        <input type="text" size="4" data-stripe="cvc"/>
      </label>
    </div>

    <div class="form-row">
      <label>
        <span>Expiration (MM/YYYY)</span>
        <input type="text" size="2" data-stripe="exp-month"/>
      </label>
      <span> / </span>
      <input type="text" size="4" data-stripe="exp-year"/>
    </div>
    <div class="form-row">
      <label><span>Current Bid:</span></label>
      <h3>${{currentbid}}</h3>
    </div>

    <button type="submit">Submit Payment</button>
  </form>
{{/auctions}}

<script type="text/javascript" src="https://js.stripe.com/v2/"></script>
<script type="text/javascript">
  // This identifies your website in the createToken call below
  Stripe.setPublishableKey('pk_test_aWtdRLag3LdKmvllpRnyFMmN');
  // ...

  function stripeResponseHandler(status, response) {
    var form = req.body;
    console.log(form);
    if (response.error) {
      // Show the errors on the form
      res.redirect('/:id/buy', {errors: response.error});
    } else {
      // response contains id and card, which contains additional card details
      var token = response.id;
      // Insert the token into the form so it gets submitted to the server

    }
  }
</script>
